# React: Интересные моменты, установка

<br>

## Основные составляющие

* `сreate-react-app (CRA)` – утилита React, создающая окружение, подключающая нужные npm-модули, создание начальной структуры приложения (отдельно устанавливать глобальный npm-пакет больше не нужно).
* `Webpack` – отвечает за сборку модулей в банлд, живую перезагрузку на сервере.
* `Babel` – минимизирует код, конвертирует код JS/JSX в старый стандарт JS с помощью плагина plugin-transform-react-jsx, он включен в пресет @babel/preset-react.

| JSX (with Babel) | JS (with React) | Output (virtual-DOM) | Output (DOM) |
|------------------|-----------------|----------------------|--------------|
| <h1>Hello!</h1>	| React.createElement(‘h1’, {className: ‘class2..’}, ‘Hello!’) | { type: ‘h1’, props: {className: ‘class2’ children: ‘Hello!’} } | <h1>Hello!</h1> |

* `ESLint` – валидирует код реакт-компонентов, выводит сообщения в терминал.
* `WebVitals` – библиотека для измерения производительности приложения.
* `React (импорт-класс)` – отвечает за работу JSX и внутренних возможностей React.
* `ReactDOM (импорт-класс)` – позволяет работать с ДОМ-структурой на странице.

В 17 версии больше __не нужно подключать React/ReactDOM в каждый модуль__, теперь только во входном модуле с главным компонентом.

<br>

## Установка CRA
Чтобы развернуть шаблон начального проекта достаточно запустить:  
```
npx create-react-app [project_name] // запускаем в папке проектов
// в отличии от npm – npx позволяет запускать ремоут пакеты без установки
cd project_name // перемещаемся в папку проекта

npm start // скрипт запуска приложения и сервера
npm build // скрипт сборки приложения
```

Чтобы не создавать каждый компонент вручную:  
```
// спец-утилита создаст структуру готового компонента: папку и типовые файлы в ней, 
npx crcf src/components/error-indicator 

someComp
├── someComp.js
├── someComp.jsx
├── someComp.scss
└── someComp.js
```
<br>

## Моменты
* `Null`, `undefined` и прочие пустые значения не отображаются при рендере react-компонентов. 
* { Array } – отобразится склеяный массив. 
* { Object } – объекты нельзя вставлять на страницу, так как могут быть обработанны корректно в строку.
* `Управляемые компоненты (контролируемые)` – которые получают свое значения из `state`, при этом сами могут менять	этот `state`. 
* `Неуправляемые компоненты` – хранят свое значение прямо в `DOM`, это не лучшее решение.
* `<React.Fragment>` – позволяет обернуть несколько элементов в один контейнер для соблюдения правил JSX, без создания дополнительного видимого DOM-элемента, сам фрагмент в верстку не попадет (сокращенная запись <>…</>).
* `key = id` – каждому дочернему элементу в массиве или списке при рендере требуется установить свой атрибут `key` с каким либо уникальным `id`. Это требование внутреннего `«механизма сравнения»`, чтобы понимать итоговые изменения дерева и различать похожие элементы.
* `События onChange и onInput` – в React работают одинаково, то есть при вводе каждого символа.

<br>

## Объект { props }
* Объект `props` есть у каждого компонента: его содержимое собирается из значений атрибутов переданных родительским компонентом. Сам компонент не может менять значение своих `props`. А при изменении извне компонент будет перерисован.

<br>

## Метод `Render` вызывает перерисовку, когда:
* Происходит вызов this.setState (изменяется State компонента)
* Изменяются входные свойства у комонента (Props)

<br>

## Состояние нельзя менять напрямую, только через `this.setState()`: 
* Если новое состояние не зависит от предыдущего – просто передаем объект с новыми свойствам `{ ...states }`;
* Если новое состояние зависит от предыдущего – передаем каллбек (state) => {}, возвращающий объект с измененными свойствами;

<br>

## Переменные окружения
В коде проекта можно использовать `переменные окружения` – это такие переменные, которые существуют в рамках запущенной сессии командного интерпретатора и подгружаются туда во время его инициализации. 

```javascript
process.env.PUBLIC_URL
// объект process.env хранит переменные окружение (эта, например - адрес проекта)
```

Чтобы создать свои переменные окружения в рамках React-приложения:
1.  Создать файл `.env` в папке `src`;
2.  Создать внутри переменную с префиксом `REACT_APP_` в имени;
```javascript
// эта переменная внутри файла .env теперь будет доступна везду (как глобальная)
REACT_APP_API_KEY=your_api_key
```
3.  Теперь добавим файлы с расширением `.env` в `.gitignore` чтобы не слить все секреты в репозиторий :)
4.  Обращаться к созданной переменной в коде мы можем через свойства объекта окружения `process.env`.
```javascript
console.log(process.env.REACT_APP_API_KEY)
// таким образом, при разработке в своей системе мы сможем работать с API
// а тому, кто возьмет проект с репозитория понадобится создать свою переменную окружения
```
