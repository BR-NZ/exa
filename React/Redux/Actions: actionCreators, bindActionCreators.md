# Actions: actionCreators, bindActionCreators
_Работы с действиями диспетчера: способы создания и оптимизации_

__`Action (действие)`__ — это простой объект, который содержит все что нужно для изменения состояния. Для этого `action` передается при вызове методу `dispatch( action )`. Далее `action` вместе с текущим `state` передается в хранилище методу `reducer`, где происходит создание нового состояния.

<br>

## Структура `Action`:
```javascript
{
  type: 'INCREMENT', // [обязательно] указывает способ изменения состояния в reducer
  payload: 3, // [опционально] обычно, содержит доп-аргументы для reducer
  someData: [1, 2, 3] // никто не мешает передать что-то еще в reducer
}
```
Свойство `type` обязательное в `{action}`, его значения принято указывать в виде строк в верхнем регистре.

<br>

## Использование:
```javascript
// где-то внутри компонента (то есть в UI)
// например, при клике передаем действие "выделения"

const onClick = () => dispatcher( {type: 'SELECT'} )
```

<br>

## Функции-создатели `actionCreators`:
При разработке приложений передавать объект-действий в `dispatch` приходится часто, это раздувает и усложняет код, приводит к опечаткам и пр.

__`actionCreators (креатор)`__ — реализованная нами функция "фабрика действия", которая должна возвращать какой-то объект действия. 

```javascript
// функция-создатель объекта действия
const inc = () => ({type: 'INCREMENT'})

// а вот применение в новом виде
const onClick = () => dispatcher( inc() )

/* в функциях-креаторах могут быть запросы на сервер и другой асинхронный код.. */
```

* Упрощает процесс создания действий, ведь теперь в `dispatch` передается не объект, а вызов функции-создателя;
* Ошибка в вызове функции-креаторе будет сразу видна (при обычной передаче объекта, опечатка себя не покажет);
* Исключаются опечатки, ведь объекты действия конструируются в функции;

> Все __действия `action` или создатели действий `actionCreator`__, как правило, __размещают в отдельном модуле__ в виде экспортов функций. А при надобности импортируют в тот модуль, где собираются использовать.

<br>

## Функции-привязки `bindActionCreators`:
В `redux` приложениях существует большая вложенность вызовов функций при работе с состоянием. Поэтому принято использовать различные функции-обертки, которые упрощают код и уменьшают вложенность.

<br>

### Функция-привязки `dispatch` к `action`
```javascript
// функция-обертка вызывает диспетчер с action или actionCreator
const incDispatch = () => dispatch( inc() )

// теперь можно вызывать только ее (без диспетчера и действия)
const onClick = () => incDispatch()
```

Разумеется это не всегда удобно, ведь в приложении может быть множество действий и  не хотелось бы под каждое создавать подобную функцию.

__`bindActionCreators`__ — вспомогательные функции, оборачивают внутри себя вызов `dispatch` и передачу ему какого-либо `action` или `actionCreator`. 

<br>

### Собственная реализация `bindActionCreator`
```javascript
// универсальная функция привязки
// будет возвращать функцию с привязанным действием к диспетчеру

const bindActionCreator = (creator, dispatch) => (
  (...args) => dispatch( creator(...args) )
)

// создаем функцию привязки с помощью нашего конструтора
// также в новую функцию можно передать аргументы, они прокинутся через конструтор в сам actionCreator

const incDispatch = bindActionCreator(inc(9), dispatch)
```

<br>

### Функция привязки `bindActionCreators` из пакета `redux`
Паттерн из примера выше стал настолько распространенным, что в пакет `redux` включили готовую функцию привязки.

Вот как это делается для каждого действия в отдельности:  
```
import { createStore, bindActionCreators } from 'redux'

// теперь с помощью готового конструктора из пакета
// сделаем все то же самое - создадим функцию вызова диспетчера с действием

const incDispatch = bindActionCreators(inc, dispatch)
/* ... и так каждое действие */
```

Процесс можно оптимизировать: все действия привязать к одному диспетчеру и получить готовые функции. `bindActionCreators` из библиотеки может принимать первым аргументом объект следующего вида:  

```javascript
// так можно сразу создать множество функций с заданными диспетчером и опеределенным креатором 
// bindActionCreators возвращает объект с готовыми функциями - которые можно сразу деструктурировать

const {incDispatch, decDispatch} = bindActionCreators({
  incDispatch: inc,
  decDispatch: dec,
  /* ...итд привязываем к функциям диспечтер с креатором */
}, dispatch)
```

<br>

### Прием с переназначением имен креаторов на имена функции-диспатчеры
Часто в `redux` приложениях применяют следующий прием:  
1. Функции-креаторы импортируют как один объект:  
```javascript
import * as actions from './actions'
```
3. А готовые функции привязки именуют одинаково с креаторами из импорта;
4. Тогда в `bindActionCreators` первым аргументом можно передать:
```javascript
const {inc, dec} = bindActionCreators({
  inc: inc, // => то же самое, что просто: inc
  dec: dec // => то же самое, что просто: dec
}, dispatch)
```
4. Что в свою очередь можно упростить до:
```javascript
const {inc, dec} = bindActionCreators(actions, dispatch)
```
