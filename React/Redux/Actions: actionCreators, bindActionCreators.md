# Actions: actionCreators, bindActionCreators
_Работы с действиями диспетчера: способы создания и оптимизации_

__`Action (действие)`__ — это простой объект, который содержит все что нужно для изменения состояния. Для этого он передается при вызове методу `dispatch`. Далее действие передается методу `reducer` в хранилище, где он используется для изменения состояния.

<br>

## Структура `Action`:
```javascript
{
  type: 'INCREMENT', // [обязательно] указывает способ изменения состояния в reducer
  payload: 3, // [опционально] обычно, содержит доп-аргументы для reducer
  someData: [1, 2, 3] // никто не мешает передать что-то еще в reducer
}
```
Свойство `type` обязательное в `{action}`, его значения принято указывать в виде строк в верхнем регистре.

<br>

## Использование:
```javascript
// где-то внутри компонента (то есть в UI)
// например, при клике передаем действие "выделения"

const onClick = () => dispatcher( {type: 'SELECT'} )
```

<br>

## Функции-создатели `actionCreators`:
При разработке приложений передавать объект-действий в `dispatcher` приходится часто - это раздувает и усложняет код, приводит к опечаткам и пр.

__`actionCreators (креатор)`__ — реализованная нами функция, которая должна возвращать какой-то объект действия. 

```javascript
// функция-создатель объекта действия
const inc = () => ({type: 'INCREMENT'})

// а вот применение в новом виде
const onClick = () => dispatcher( inc() )

/* в функциях-креаторах могут быть запросы на сервер и другой асинхронный код.. */
```

* Упрощает процесс создания действий, ведь теперь в `dispatcher` передается не объект, а вызов функции-создателя;
* Ошибка в вызове функции-креаторе будет сразу видна (при обычной передаче объекта, опечатка себя не покажет);
* Исключаются опечатки, ведь объекты действия конструируются в функции;

> Все __действия `action` или создатели действий `actionCreator`__, как правило, __размещают в отдельном модуле__ в виде экспортов функций. А при надобности импортируют в тот модуль, где собираются использовать.

<br>

## Функции-привязки `bindActionCreators`:
В `redux` приложениях существует большая вложенность вызовов функций при работе с состоянием. Поэтому принято использовать различные функции-обертки.

<br>

### Функция-привязки `dispatcher` к `action`
```javascript
// функция-обертка вызывает диспетчер с action или actionCreator
const incDispatch = () => dispatch( inc() )

// теперь можно вызывать только ее (без диспетчера и действия)
const onClick = () => incDispatch()
```

Разумеется это не всегда удобно, ведь в приложении может быть множество действий и  не хотелось бы под каждое создавать подобную функцию.

__`bindActionCreators`__ — вспомогательные функции, оборачивают внутри себя вызов `dispatcher` и передачу ему какого-либо `action` или `actionCreator`. Эти вспомогательные функции-обертки также служат для оптимизации, но на уровень выше `actionCreators`.

<br>

### Собственная реализация `bindActionCreator`
```javascript
// универсальная функция привязки
// будет возвращать функцию с привязанным действием и диспетчером

const bindActionCreator = (creator, dispatch) => (
  (...args) => dispatch( creator(...args) )
)

// создаем функцию привязки с помощью нашего конструтора
// в creator можно передать аргументы, они прокинутся через конструтор в сам actionCreator

const incDispatch = bindActionCreator(inc(9), dispatch)
```

<br>

### Функция привязки `bindActionCreators` из пакета `redux`
Паттерн из примера выше стал настолько распространенным, что в пакет `redux` включили готовую функцию привязки.

Вот как это делается для каждого действия в отдельности:  
```
import { createStore, bindActionCreators } from 'redux'

// теперь с помощью готового конструтора из пакета
// сделаем все то же самое - создадим функцию вызова диспетчера с действием

const incDispatch = bindActionCreators(inc, dispatch)
/* ... и так каждое действие */
```

Но процесс можно оптимизировать, все действия можно привязать к одному диспетчеру и получить готовые функции. Импортируемые из библиотеки `bindActionCreators` может принимать первым аргументом объект следующего вида:  

```javascript
// так можно сразу создать множество функций с заданными диспетчером и опеределенным креатором или действием

const {incDispatch, decDispatch} = bindActionCreators({
  incDispatch: inc,
  decDispatch: dec,
  /* ...итд привязываем диспечтер с креатором действия к функциям */
}, dispatch)

// bindActionCreators возвращает объект с готовыми функциями - можно деструктурировать
```

<br>

### Прием с переназначением имен креаторов на функции привязки
Часто в `redux` приложениях применяют следующий прием:  
1. Функции-креаторы импортируют как один объект:  
```javascript
import * as actions from './actions'
```
3. А готовые функции привязки именуют одинаково с креаторами из импорта;
4. Тогда в `bindActionCreators` первым аргументом можно передать:
```javascript
const {inc, dec} = bindActionCreators({
  inc: inc, // => то же самое, что просто: inc
  dec: dec // => то же самое, что просто: dec
}, dispatch)
```
4. Что в свою очередь можно упростить до:
```javascript
const {incDispatch, decDispatch} = bindActionCreators(actions, dispatch)
```
