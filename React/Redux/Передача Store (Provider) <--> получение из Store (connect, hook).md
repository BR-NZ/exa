# Передача Store `<Provider>` <--> получение из Store

`Redux` позволяет иметь глобальное состояние, доступное любому компоненту и в любом уровне вложенности.

## Передача `store`
Для передачи состояния дочерним компонентам нам понадобится специальный компонент библиотеки:
```javascript
import { Provider } from 'react-redux';
```

Его необходимо размещать в том "верхнем" родительском компоненте, где мы создавали или импортировали хранилище:  
```javascript
/* например, в index.js */
const root = ReactDOM.createRoot(document.getElementById('root'));

// создаем или импортируем store
const store = createStore(reducer);

root.render(
  <Provider store = { store }>
    <App />
  </Provider>
);
```

1. __`<Provider>`__ должен получать созданное `redux` состояние в виде пропса `store`;
2. __`<Provider>`__ должен оборачивать собой все компоненты, которым нужны данные хранилища — они смогут получить его в виде пропсов одним из двух способов: хук `useSelector()` или hoc `connect()`;
3. __`<Provider>`__ будет также оповещать своих потомков, которые к нему подключены, о любом изменении хранилища и вызывать их ререндер.

<br>

## Получаем через [`connect()`](https://react-redux.js.org/api/connect)

__`connect()`__ — компонент высшего порядка, который оборачивает собой `компонент-получатель` и позволяет ему получать текущее `redux-состояние` через пропсы. То есть он возвращает тот же компонент, но с дополнительными возможностями.

### Настройка:
Для работы `connect()` нуждается в настройке — передаче в аргументы специальных функций и объектов.

__Аргументы `connect()` по очереди:  
* __`mapStateToProps`__ — реализованная нами функция трансформирования свойств `state` от `redux` в пропсы для компонента-получателя. Получает текущий `state`, а возвращать должна объект вида `props : state`;
* __`mapDispatchToProps`__ — реализованная нами функция трансформирования действий в пропсы для компонента-получателя. Получает `dispatch`, а возвращать должна объект вида `props : диспатч`;
* Есть и другие редко применяемые параметры;

### Применение:
```javascript
import { connect } from "react-redux";
import { bindActionCreators } from "redux";

// тут наши функции-креаторы действий
import * as actions from "../actions"

// компонент-получатель как обычно ждет данные через пропсы..
const Counter = ({counter, inc, dec, rnd}) => {
    /* какая-то логика */
}

// функция для перевода свойств state --> в пропсы компонента
const mapStateToProps = (state) => ({ counter: state.value })

// функция для перевода действий --> в пропсы компонента
const mapDispatchToProps = (dispatch) => {
    return {
        inc: () => dispatch( actions.inc() ),
        dec: () => dispatch( actions.dec() ),
        rnd: () => dispatch( actions.rnd() )
    }
    
    // ..а можно вернуть сразу результат bindActionCreators
    return bindActionCreators(actions, dispatch)
    // который сам вернет задиспатченные креаторы-действий в виде объекта
}

// тут удобно обернуть компонент-получатель в HOC-connect
// и в собранный проект попадет уже усовершенствованный компонент
export default connect(mapStateToProps, mapDispatchToProps)(Counter)

// ВАЖНО: connect() устроен так, что если 2м аргументом идет объект-действий
// то он сам все задиспатчит без mapDispatchToProps и bindActionCreators
export default connect(mapStateToProps, actions)(Counter)
```

### Моменты:
* __`connect()`__ это самый старый способ связи с хранилищем, он появился до аналогичного хука, не рекомендован документацией, но может встречаться в старых проектах;
* Приводит к большему объему `boiler-кода`;
* Может работать с классовыми компонентами;
* Лучше поддается тестированию;
* Лучшая производительность; 

<br>

## Получаем через [`useSelector()`]()
